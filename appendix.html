<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Appendix | Shrinking Characteristics of Precision Matrix Estimators: An Illustration via Regression</title>
  <meta name="description" content="Matt Galloway’s Master’s thesis.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="A Appendix | Shrinking Characteristics of Precision Matrix Estimators: An Illustration via Regression" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://mattxgalloway.com/oral_manuscript/" />
  
  <meta property="og:description" content="Matt Galloway’s Master’s thesis." />
  <meta name="github-repo" content="MGallow/oral_manuscript" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Appendix | Shrinking Characteristics of Precision Matrix Estimators: An Illustration via Regression" />
  
  <meta name="twitter:description" content="Matt Galloway’s Master’s thesis." />
  

<meta name="author" content="Matt Galloway">


<meta name="date" content="2019-04-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="scpme.html">
<link rel="next" href="admmsigma-r-package.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Matt Galloway Oral Manuscript</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="precision-matrix-estimation.html"><a href="precision-matrix-estimation.html"><i class="fa fa-check"></i><b>2</b> Precision Matrix Estimation</a><ul>
<li class="chapter" data-level="2.1" data-path="precision-matrix-estimation.html"><a href="precision-matrix-estimation.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="precision-matrix-estimation.html"><a href="precision-matrix-estimation.html#admm-algorithm"><i class="fa fa-check"></i><b>2.2</b> ADMM Algorithm</a></li>
<li class="chapter" data-level="2.3" data-path="precision-matrix-estimation.html"><a href="precision-matrix-estimation.html#simulations"><i class="fa fa-check"></i><b>2.3</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scpme.html"><a href="scpme.html"><i class="fa fa-check"></i><b>3</b> SCPME</a><ul>
<li class="chapter" data-level="3.1" data-path="scpme.html"><a href="scpme.html#augmented-admm-algorithm"><i class="fa fa-check"></i><b>3.1</b> Augmented ADMM Algorithm</a></li>
<li class="chapter" data-level="3.2" data-path="scpme.html"><a href="scpme.html#regression-illustration"><i class="fa fa-check"></i><b>3.2</b> Regression Illustration</a></li>
<li class="chapter" data-level="3.3" data-path="scpme.html"><a href="scpme.html#simulations-1"><i class="fa fa-check"></i><b>3.3</b> Simulations</a></li>
<li class="chapter" data-level="3.4" data-path="scpme.html"><a href="scpme.html#discussion"><i class="fa fa-check"></i><b>3.4</b> Discussion</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a></li>
<li class="chapter" data-level="B" data-path="admmsigma-r-package.html"><a href="admmsigma-r-package.html"><i class="fa fa-check"></i><b>B</b> <code>ADMMsigma</code> R Package</a><ul>
<li class="chapter" data-level="B.1" data-path="admmsigma-r-package.html"><a href="admmsigma-r-package.html#installation"><i class="fa fa-check"></i><b>B.1</b> Installation</a></li>
<li class="chapter" data-level="B.2" data-path="admmsigma-r-package.html"><a href="admmsigma-r-package.html#tutorial"><i class="fa fa-check"></i><b>B.2</b> Tutorial</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="scpme-r-package.html"><a href="scpme-r-package.html"><i class="fa fa-check"></i><b>C</b> <code>SCPME</code> R Package</a><ul>
<li class="chapter" data-level="C.1" data-path="scpme-r-package.html"><a href="scpme-r-package.html#installation-1"><i class="fa fa-check"></i><b>C.1</b> Installation</a></li>
<li class="chapter" data-level="C.2" data-path="scpme-r-package.html"><a href="scpme-r-package.html#tutorial-1"><i class="fa fa-check"></i><b>C.2</b> Tutorial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Shrinking Characteristics of Precision Matrix Estimators: An Illustration via Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix" class="section level1">
<h1><span class="header-section-number">A</span> Appendix</h1>
<div id="proofomegaalgo" class="section level3">
<h3><span class="header-section-number">A.0.1</span> Proof of <a href="precision-matrix-estimation.html#eq:omegaalgo">(2.15)</a></h3>
<p><span class="citation">Witten and Tibshirani (<a href="#ref-witten2009covariance">2009</a>)</span> and <span class="citation">Price, Geyer, and Rothman (<a href="#ref-price2015ridge">2015</a>)</span> showed that the following optimization problem can be solved in closed-form. We outline their steps here.</p>
<p><span class="math display" id="eq:appendixomegaloglik">\[\begin{equation}
\Omega^{k + 1} = \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[\Lambda^{k}\left(\Omega - Z^{k}\right)\right] + \frac{\rho}{2}\left\| \Omega - Z^{k} \right\|_{F}^{2} \right\}
\tag{A.1}\notag
\end{equation}\]</span></p>
<p>First start by taking the gradient with respect to <span class="math inline">\(\Omega\)</span>:</p>
<p><span class="math display" id="eq:appendixomegagradient">\[\begin{equation}
\begin{split}
  \nabla_{\Omega}&amp;\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[\Lambda^{k}\left(\Omega - Z^{k}\right)\right] + \frac{\rho}{2}\left\| \Omega - Z^{k} \right\|_{F}^{2} \right\} \\
  &amp;= S - \Omega^{-1} + \Lambda^{k} + \rho\left( \Omega - Z^{k} \right)
\tag{A.2}\notag
\end{split}
\end{equation}\]</span></p>
<p>Note that because all of the variables are symmetric, we can ignore the symmetric constraint when deriving the gradient. Next set the gradient equal to zero and decompose <span class="math inline">\(\Omega^{k + 1} = VDV&#39;\)</span> using spectral decomposition so that <span class="math inline">\(D\)</span> is a diagonal matrix with diagonal elements equal to the eigen values of <span class="math inline">\(\Omega^{k + 1}\)</span> and <span class="math inline">\(V\)</span> is the matrix with corresponding eigen vectors as columns so that</p>
<p><span class="math display">\[\begin{equation}
S + \Lambda^{k} - \rho Z^{k} = (\Omega^{k + 1})^{-1} - \rho \Omega^{k + 1} = VD^{-1}V&#39; - \rho VDV&#39; =  V\left(D^{-1} - \rho D\right)V&#39;\notag
\end{equation}\]</span></p>
<p>This equivalence implies that</p>
<p><span class="math display">\[\begin{equation}
\phi_{j}\left( S + \Lambda^{k} - \rho Z^{k} \right) = \frac{1}{\phi_{j}(\Omega^{k + 1})} - \rho\phi_{j}(\Omega^{k + 1})\notag
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\phi_{j}(\cdot)\)</span> is the <span class="math inline">\(j\)</span>th eigen value.</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
  &amp;\Rightarrow \rho\phi_{j}^{2}(\Omega^{k + 1}) + \phi_{j}\left( S + \Lambda^{k} - \rho Z^{k} \right)\phi_{j}(\Omega^{k + 1}) - 1 = 0 \\
  &amp;\Rightarrow \phi_{j}(\Omega^{k + 1}) = \frac{-\phi_{j}(S + \Lambda^{k} - \rho Z^{k}) \pm \sqrt{\phi_{j}^{2}(S + \Lambda^{k} - \rho Z^{k}) + 4\rho}}{2\rho}
\end{split}
\notag
\end{equation}\]</span></p>
<p>In summary, if we decompose <span class="math inline">\(S + \Lambda^{k} - \rho Z^{k} = VQV&#39;\)</span> then</p>
<p><span class="math display" id="eq:appendixomegaproof">\[\begin{equation}
\Omega^{k + 1} = \frac{1}{2\rho}V\left[ -Q + (Q^{2} + 4\rho I_{p})^{1/2}\right] V&#39;
\tag{A.3}
\end{equation}\]</span></p>
</div>
<div id="proofZZalgo" class="section level3">
<h3><span class="header-section-number">A.0.2</span> Proof of <a href="precision-matrix-estimation.html#eq:ZZalgo">(2.16)</a></h3>
<p>Solve the optimization problem</p>
<p><span class="math display" id="eq:appendixZZloglik">\[\begin{equation}
Z^{k + 1} = \arg\min_{Z \in \mathbb{S}^{p}}\left\{ \lambda\left[ \frac{1 - \alpha}{2}\left\| Z \right\|_{F}^{2} + \alpha\left\| Z \right\|_{1} \right] + tr\left[\Lambda^{k}\left(\Omega^{k + 1} - Z\right)\right] + \frac{\rho}{2}\left\| \Omega^{k + 1} - Z \right\|_{F}^{2} \right\}
\tag{A.4}\notag
\end{equation}\]</span></p>
<p>Start by taking the subgradient with respect to <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display" id="eq:appendixZZgradient">\[\begin{equation}
\begin{split}
  \partial&amp;\left\{ \lambda\left[ \frac{1 - \alpha}{2}\left\| Z \right\|_{F}^{2} + \alpha\left\| Z \right\|_{1} \right] + tr\left[\Lambda^{k}\left(\Omega^{k + 1} - Z\right)\right] + \frac{\rho}{2}\left\| \Omega^{k + 1} - Z \right\|_{F}^{2} \right\} \\
  &amp;= \partial\left\{ \lambda\left[ \frac{1 - \alpha}{2}\left\| Z \right\|_{F}^{2} + \alpha\left\| Z \right\|_{1} \right] \right\} + \nabla_{\Omega}\left\{ tr\left[\Lambda^{k}\left(\Omega^{k + 1} - Z\right)\right] + \frac{\rho}{2}\left\| \Omega^{k + 1} - Z \right\|_{F}^{2} \right\} \\
  &amp;= \lambda(1 - \alpha)Z + \mbox{sign}(Z)\lambda\alpha - \Lambda^{k} - \rho\left( \Omega^{k + 1} - Z \right)
\tag{A.5}\notag
\end{split}
\end{equation}\]</span></p>
<p>where sign is the elementwise sign operator. By setting the gradient/sub-differential equal to zero, we have that</p>
<p><span class="math display" id="eq:ZZsoftproof">\[\begin{equation}
Z_{ij}^{k + 1} = \frac{1}{\lambda(1 - \alpha) + \rho}\left( \rho \Omega_{ij}^{k + 1} + \Lambda_{ij}^{k} - \mbox{sign}(Z_{ij}^{k + 1})\lambda\alpha \right)
\tag{A.6}\notag
\end{equation}\]</span></p>
<p>for all <span class="math inline">\(i = 1,..., p\)</span> and <span class="math inline">\(j = 1,..., p\)</span>. We observe two scenarios:</p>
<ul>
<li>If <span class="math inline">\(Z_{ij}^{k + 1} &gt; 0\)</span> then</li>
</ul>
<p><span class="math display">\[\begin{equation}
\rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k} &gt; \lambda\alpha \notag
\end{equation}\]</span></p>
<ul>
<li>If <span class="math inline">\(Z_{ij}^{k + 1} &lt; 0\)</span> then</li>
</ul>
<p><span class="math display">\[\begin{equation}
\rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k} &lt; -\lambda\alpha \notag
\end{equation}\]</span></p>
<p>This implies that <span class="math inline">\(\mbox{sign}(Z_{ij}) = \mbox{sign}(\rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k})\)</span>. Putting all the pieces together, we arrive at</p>
<p><span class="math display" id="eq:appendixZZproof">\[\begin{equation}
\begin{split}
Z_{ij}^{k + 1} &amp;= \frac{1}{\lambda(1 - \alpha) + \rho}\mbox{sign}\left(\rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k}\right)\left( \left| \rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k} \right| - \lambda\alpha \right)_{+} \\
&amp;= \frac{1}{\lambda(1 - \alpha) + \rho}\mbox{soft}\left(\rho\Omega_{ij}^{k + 1} + \Lambda_{ij}^{k}, \lambda\alpha\right)
\tag{A.7}\notag
\end{split}
\end{equation}\]</span></p>
<p>where soft is the soft-thresholding function.</p>
</div>
<div id="proofdualresidual" class="section level3">
<h3><span class="header-section-number">A.0.3</span> Proof of the dual residual</h3>
<p>Here we want to show that <span class="math inline">\(0 \in \rho\left(Z^{k + 1} - Z^{k}\right)\)</span> which is a direct result of the fact that <span class="math inline">\(\Omega^{k + 1}\)</span> is the minimizer of the augmented lagrangian and <span class="math inline">\(0 \in f\left(\Omega^{k + 1}\right) + \Lambda^{k + 1}\)</span>.</p>
<p><span class="math display" id="eq:appendixdualresidual">\[\begin{equation}
\begin{split}
  0 &amp;\in \partial \left\{ f\left(\Omega^{k + 1}\right) + tr\left[ \Lambda^{k}\left( \Omega^{k + 1} - Z^{k} \right) \right] + \frac{\rho}{2}\left\| \Omega^{k + 1} - Z^{k} \right\|_{F}^{2} \right\} \\
  &amp;= \partial f\left(\Omega^{k + 1}\right) + \Lambda^{k} + \rho\left(\Omega^{k + 1} - Z^{k}\right) \\
  &amp;= \partial f\left(\Omega^{k + 1}\right) + \Lambda^{k} + \rho\left(\Omega^{k + 1} + Z^{k + 1} - Z^{k + 1} - Z^{k}\right) \\
  &amp;= \partial f\left(\Omega^{k + 1}\right) + \Lambda^{k} + \rho\left(\Omega^{k + 1} - Z^{k + 1}\right) + \rho\left(Z^{k + 1} - Z^{k}\right) \\
  &amp;= \partial f\left(\Omega^{k + 1}\right) + \Lambda^{k + 1} + \rho\left(Z^{k + 1} - Z^{k}\right) \\
  \Rightarrow 0 &amp;\in \rho\left( Z^{k + 1} - Z^{k} \right)
\tag{A.8}\notag
\end{split}
\end{equation}\]</span></p>
</div>
<div id="proofdualopt" class="section level3">
<h3><span class="header-section-number">A.0.4</span> Proof of second dual optimality condition</h3>
<p>Here we use the primal optimality condition <span class="math inline">\(\Omega^{k + 1} - Z^{k + 1} = 0\)</span> to show that the second dual optimality condition <span class="math inline">\(0 \in \partial g\left(Z^{k + 1}\right) - \Lambda^{k + 1}\)</span> is always satisfied.</p>
<p><span class="math display" id="eq:appendixdualopt">\[\begin{equation}
\begin{split}
  0 &amp;\in \partial \left\{ g\left(Z^{k + 1}\right) + tr\left[ \Lambda^{k}\left( \Omega^{k + 1} - Z^{k + 1} \right) \right] + \rho\left\| \Omega^{k + 1} - Z^{k + 1} \right\|_{F}^{2} \right\} \\
  &amp;= \partial g\left(Z^{k + 1}\right) - \Lambda^{k} - \rho\left(\Omega^{k + 1} - Z^{k + 1}\right) \\
  &amp;= \partial g\left(Z^{k + 1}\right) - \Lambda^{k + 1} \\
\tag{A.9}\notag
\end{split}
\end{equation}\]</span></p>
</div>
<div id="taylorsexp" class="section level3">
<h3><span class="header-section-number">A.0.5</span> Explanation of majorizing function <a href="scpme.html#eq:approx">(3.5)</a></h3>
<p>To see why this particular function was used, consider the Taylor’s expansion of <span class="math inline">\(\rho\left\|A\Omega B - Z^{k} - C\right\|_{F}^{2}/2\)</span>:</p>
<p><span class="math display" id="eq:taylors">\[\begin{equation}
\begin{split}
  \frac{\rho}{2}\left\| A\Omega B - Z^{k} - C \right\|_{F}^{2} &amp;\approx \frac{\rho}{2}\left\| A\Omega^{k} B - Z^{k} - C \right\|_{F}^{2} \\
  &amp;+ \frac{\rho}{2}vec\left( \Omega - \Omega^{k}\right)&#39;\left(A&#39;A \otimes BB&#39;\right)vec\left(\Omega - \Omega^{k}\right) \\
  &amp;+ \rho vec\left(\Omega - \Omega^{k}\right)&#39;vec\left(BB&#39;\Omega^{k}A&#39;A - B(Z^{k})&#39;A - BC&#39;A \right)
\tag{A.10}\notag
\end{split}
\end{equation}\]</span></p>
<p>Note that the gradient and hessian, respectively, are</p>
<p><span class="math display" id="eq:gradient">\[\begin{equation}
  \nabla_{\Omega}\left\{ \frac{\rho}{2}\left\|A\Omega B - Z - C\right\|_{F}^{2} \right\} = \rho BB&#39;\Omega A&#39;A - \rho BZ&#39;A - \rho BC&#39;A
\tag{A.11}\notag
\end{equation}\]</span></p>
<p><span class="math display" id="eq:hessian">\[\begin{equation}
\nabla_{\Omega}^{2}\left\{ \frac{\rho}{2}\left\|A\Omega B - Z - C \right\|_{F}^{2} \right\} = \rho\left(A&#39;A \otimes BB&#39; \right)
\tag{A.12}\notag
\end{equation}\]</span></p>
<p>This implies that</p>
<p><span class="math display" id="eq:penapprox">\[\begin{equation}
\begin{split}
  \frac{\rho}{2}\left\| A\Omega B - Z^{k} - C \right\|_{F}^{2} &amp;+ \frac{\rho}{2}vec\left(\Omega - \Omega^{k} \right)&#39;Q\left(\Omega - \Omega^{k} \right) \\
  &amp;\approx \frac{\rho}{2}\left\| A\Omega^{k} B - Z^{k} - C \right\|_{F}^{2} + \frac{\rho}{2}vec\left(\Omega - \Omega^{k} \right)&#39;Q\left(\Omega - \Omega^{k} \right) \\
  &amp;+ \frac{\rho}{2}vec\left( \Omega - \Omega^{k}\right)&#39;\left(A&#39;A \otimes BB&#39;\right)vec\left(\Omega - \Omega^{k}\right) \\
  &amp;+ \rho vec\left(\Omega - \Omega^{k}\right)&#39; vec\left(BB&#39;\Omega^{k}A&#39;A - B(Z^{k})&#39;A - BC&#39;A \right) \\
  &amp;= \frac{\rho}{2}\left\| A\Omega^{k} B - Z^{k} - C \right\|_{F}^{2} + \frac{\rho\tau}{2}\left\|\Omega - \Omega^{k}\right\|_{F}^{2} \\
  &amp;+ \rho tr\left[\left(\Omega - \Omega^{k}\right)\left(BB&#39;\Omega^{k}A&#39;A - B(Z^{k})&#39;A - BC&#39;A \right)\right]
\tag{A.13}\notag
\end{split}
\end{equation}\]</span></p>
<p>Let us now plug in this equality into our optimization problem that includes the augmented lagrangian:</p>
<p><span class="math display" id="eq:omegaapprox">\[\begin{equation}
\begin{split}
  \hat{\Omega}^{k + 1} &amp;= \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\tilde{L}_{\rho}(\Omega, Z^{k}, \Lambda^{k}) \\
  &amp;= \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{\begin{matrix}
 tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[(\Lambda^{k})&#39;(A\Omega B - Z^{k} - C) \right] + \rho\left\|A\Omega B - Z^{k} - C \right\|_{F}^{2}/2 \end{matrix}\right. \\
  &amp;+ \left.\begin{matrix} vec\left(\Omega - \Omega^{k}\right)&#39;\rho Q\left(\Omega - \Omega^{k}\right)/2 \end{matrix}\right\} \\
  &amp;= \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{\begin{matrix}
 tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[(\Lambda^{k})&#39;(A\Omega B - Z^{k} - C) \right] + \rho\left\|A\Omega^{k} B - Z^{k} - C \right\|_{F}^{2}/2 \end{matrix}\right. \\
  &amp;+ \left.\begin{matrix} \rho\tau\left\|\Omega - \Omega^{k}\right\|_{F}^{2}/2 + tr\left[\rho\left(\Omega - \Omega^{k}\right)\left(BB&#39;\Omega^{k}A&#39;A - B(Z^{k})&#39;A - BC&#39;A \right)\right] \end{matrix}\right\} \\
  &amp;= \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{\begin{matrix}
 tr\left[\left(S + \rho A&#39;(A\Omega^{k}B - Z^{k} - C + \Lambda^{k}/\rho)B&#39; \right)\Omega\right] \end{matrix}\right. \\
  &amp;- \left.\begin{matrix} \log\left|\Omega\right| + \rho\tau\left\|\Omega - \Omega^{k}\right\|_{F}^{2}/2 \end{matrix}\right\} \\
  &amp;= \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{
 tr\left[\left(S + G^{k} \right)\Omega\right] - \log\left|\Omega\right| + \rho\tau\left\|\Omega - \Omega^{k}\right\|_{F}^{2}/2 \right\} \\
\tag{A.14}\notag
\end{split}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(G^{k} = \rho A&#39;(A\Omega^{k}B - Z^{k} - C + \Lambda^{k}/\rho)B&#39;\)</span>.</p>
</div>
<div id="proofOmegak" class="section level3">
<h3><span class="header-section-number">A.0.6</span> Proof of <a href="scpme.html#eq:Omegak">(3.9)</a></h3>
<p>We show that the following optimization problem can be solved in closed-form similar to <a href="appendix.html#eq:appendixomegaproof">(A.3)</a>.</p>
<p><span class="math display" id="eq:appendixomegaloglik2">\[\begin{equation}
\Omega^{k + 1} = \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{tr\left[\left(S + G^{k}\right)\Omega\right] - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left\|\Omega - \Omega^{k}\right\|_{F}^{2} \right\}
\tag{A.15}\notag
\end{equation}\]</span></p>
<p>First start by taking the gradient with respect to <span class="math inline">\(\Omega\)</span>:</p>
<p><span class="math display" id="eq:appendixomegagradient2">\[\begin{equation}
\begin{split}
  &amp;\nabla_{\Omega}\left\{tr\left[\left(S + G^{k}\right)\Omega\right] - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left\|\Omega - \Omega^{k}\right\|_{F}^{2} \right\} \\
  &amp;= 2S - S\circ I_{p} + G^{k} + (G^{k})&#39; - G^{k}\circ I_{p} - 2\Omega^{-1} + \Omega^{-1}\circ I_{p} \\
  &amp;+ \frac{\rho\tau}{2}\left[2\Omega - 2(\Omega^{k})&#39; + 2\Omega&#39; - 2\Omega^{k} - 2(\Omega - \Omega^{k})&#39;\circ I_{p} \right]
\tag{A.16}\notag
\end{split}
\end{equation}\]</span></p>
<p>Note that we need to honor the symmetric constraint given by <span class="math inline">\(\Omega\)</span>. By setting the gradient equal to zero and multiplying all off-diagonal elements by <span class="math inline">\(1/2\)</span>, this simplifies to</p>
<p><span class="math display">\[\begin{equation}
S + \frac{1}{2}\left(G^{k} + (G^{k})&#39;\right) - \rho\tau\Omega^{k} = (\Omega^{k + 1})^{-1} - \rho\tau\Omega^{k + 1} \notag
\end{equation}\]</span></p>
<p>We can then decompose using spectral decomposition <span class="math inline">\(\Omega^{k + 1} = VDV&#39;\)</span> where <span class="math inline">\(D\)</span> is a diagonal matrix with diagonal elements equal to the eigen values of <span class="math inline">\(\Omega^{k + 1}\)</span> and <span class="math inline">\(V\)</span> is the matrix with corresponding eigen vectors as columns.</p>
<p><span class="math display">\[\begin{equation}
S + \frac{1}{2}\left(G^{k} + (G^{k})&#39;\right) - \rho\tau\Omega^{k} = VD^{-1}V&#39; - \rho\tau VDV&#39; = V\left(D^{-1} - \rho\tau D\right)V&#39; \notag
\end{equation}\]</span></p>
<p>This equivalence implies that</p>
<p><span class="math display">\[\begin{equation}
\phi_{j}\left( D^{k} \right) = \frac{1}{\phi_{j}(\Omega^{k + 1})} - \rho\tau\phi_{j}(\Omega^{k + 1}) \notag
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\phi_{j}(\cdot)\)</span> is the <span class="math inline">\(j\)</span>th eigen value and <span class="math inline">\(D^{k} = S + \left(G^{k} + (G^{k})&#39;\right)/2 - \rho\tau\Omega^{k}\)</span>. Therefore</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
  &amp;\Rightarrow \rho\tau\phi_{j}^{2}(\Omega^{k + 1}) + \phi_{j}\left( D^{k} \right)\phi_{j}(\Omega^{k + 1}) - 1 = 0 \\
  &amp;\Rightarrow \phi_{j}(\Omega^{k + 1}) = \frac{-\phi_{j}(D^{k}) \pm \sqrt{\phi_{j}^{2}(D^{k}) + 4\rho\tau}}{2\rho\tau}
\end{split}
\notag
\end{equation}\]</span></p>
<p>In summary, if we decompose <span class="math inline">\(S + \left(G^{k} + (G^{k})&#39;\right)/2 - \rho\tau\Omega^{k} = VQV&#39;\)</span> then</p>
<p><span class="math display" id="eq:appendixomegaproof2">\[\begin{equation}
\Omega^{k + 1} = \frac{1}{2\rho\tau}V\left[ -Q + (Q^{2} + 4\rho\tau I_{p})^{1/2}\right] V&#39;
\tag{A.17}\notag
\end{equation}\]</span></p>
</div>
<div id="proofZk" class="section level3">
<h3><span class="header-section-number">A.0.7</span> Proof of <a href="scpme.html#eq:Zk">(3.10)</a></h3>
<p>Solve the optimization problem</p>
<p><span class="math display" id="eq:appendixZZloglik2">\[\begin{equation}
Z^{k + 1} = \arg\min_{Z \in \mathbb{R}^{n \times r}}\left\{ \lambda\left\| Z \right\|_{1} + tr\left[(\Lambda^{k})&#39;\left(A\Omega^{k + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left\| A\Omega^{k + 1}B - Z - C \right\|_{F}^{2} \right\}
\tag{A.18}\notag
\end{equation}\]</span></p>
<p>Start by taking the subgradient with respect to <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display" id="eq:appendixZZgradient2">\[\begin{equation}
\begin{split}
  \partial&amp;\left\{ \lambda\left\| Z \right\|_{1} + tr\left[(\Lambda^{k})&#39;\left(A\Omega^{k + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left\| A\Omega^{k + 1}B - Z - C \right\|_{F}^{2} \right\} \\
  &amp;= \partial\left\{ \lambda\left\| Z \right\|_{1} \right\} + \nabla_{\Omega}\left\{ tr\left[(\Lambda^{k})&#39;\left(A\Omega^{k + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left\| A\Omega^{k + 1}B - Z - C \right\|_{F}^{2} \right\} \\
  &amp;= \mbox{sign}(Z)\lambda - \Lambda^{k} - \rho\left( A\Omega^{k + 1}B - Z - C \right)
\tag{A.19}\notag
\end{split}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mbox{sign(Z)}\)</span> is the elementwise sign operator. By setting the gradient/sub-differential equal to zero, we arrive at the following equivalence:</p>
<p><span class="math display" id="eq:ZZsoftproof2">\[\begin{equation}
Z_{ij}^{k + 1} = \frac{1}{\rho}\left( \rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} - Sign\left(Z_{ij}^{k + 1}\right)\lambda \right)
\tag{A.20}\notag
\end{equation}\]</span></p>
<p>for all <span class="math inline">\(i = 1,..., p\)</span> and <span class="math inline">\(j = 1,..., p\)</span>. We observe two scenarios:</p>
<ul>
<li>If <span class="math inline">\(Z_{ij}^{k + 1} &gt; 0\)</span> then</li>
</ul>
<p><span class="math display">\[\begin{equation}
\rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} &gt; \lambda\alpha \notag
\end{equation}\]</span></p>
<ul>
<li>If <span class="math inline">\(Z_{ij}^{k + 1} &lt; 0\)</span> then</li>
</ul>
<p><span class="math display">\[\begin{equation}
\rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} &lt; -\lambda\alpha \notag
\end{equation}\]</span></p>
<p>This implies that <span class="math inline">\(\mbox{sign}\left(Z_{ij}^{k + 1}\right) = \mbox{sign}\left(\rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k}\right)\)</span>. Putting all the pieces together, we arrive at</p>
<p><span class="math display" id="eq:appendixZZproof2">\[\begin{equation}
\begin{split}
Z_{ij}^{k + 1} &amp;= \frac{1}{\rho}\mbox{sign}\left(\rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k}\right)\left( \left| \rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} \right| - \lambda \right)_{+} \\
&amp;= \frac{1}{\rho}\mbox{soft}\left(\rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k}, \lambda\right)
\tag{A.21}\notag
\end{split}
\end{equation}\]</span></p>
<p>where soft is the soft-thresholding function.</p>
</div>
<div id="proofstopproof" class="section level3">
<h3><span class="header-section-number">A.0.8</span> Proof of <a href="scpme.html#eq:stopproof">(3.12)</a></h3>
<p>Here we want to show that <span class="math inline">\(0 \in \rho\left( B(Z^{k + 1} - Z^{k})&#39;A + A&#39;(Z^{k + 1} - Z^{k})B&#39; \right)/2\)</span> which is a direct result of the fact that <span class="math inline">\(0 \in \partial f\left(\Omega^{k + 1} \right) + \left(B(\Lambda^{k + 1})&#39;A + A&#39;\Lambda^{k + 1}B&#39; \right)/2\)</span>.</p>
<p><span class="math display" id="eq:appendixstopproof">\[\begin{equation}
\begin{split}
  0 &amp;\in \partial \left\{ f\left(\Omega^{k + 1}\right) + tr\left[ \Lambda^{k}\left( A\Omega^{k + 1}B - Z^{k} - C \right) \right] + \rho\left\| A\Omega^{k + 1}B - Z^{k} - C \right\|_{F}^{2}/2 \right\} \\
  &amp;= \partial f\left(\Omega^{k + 1} \right) + \left(B(\Lambda^{k})&#39;A + A&#39;\Lambda^{k}B&#39; \right)/2 + \rho\left( BB&#39;\Omega^{k + 1}A&#39;A + A&#39;A\Omega^{k + 1}BB&#39; \right)/2 \\
  &amp;- \rho\left( A&#39;(Z^{k} + C)B&#39; + B(Z^{k} + C)&#39;A \right)/2 \\
  &amp;= \partial f\left(\Omega^{k + 1} \right) + \left(B(\Lambda^{k})&#39;A + A&#39;\Lambda^{k}B&#39; \right)/2 \\
  &amp;+ \rho\left( B(B&#39;\Omega^{k + 1}A&#39; - (Z^{k})&#39; - C&#39;)A + A&#39;(A\Omega^{k + 1}B - Z^{k} - C)B&#39; \right)/2 \\
  &amp;= \partial f\left(\Omega^{k + 1} \right) + \left( B(\Lambda^{k})&#39;A + A&#39;\Lambda^{k}B&#39; \right)/2 + \rho\left(A&#39;(A\Omega^{k + 1}B - Z^{k + 1} + Z^{k + 1} - Z^{k} - C)B&#39; \right)/2 \\
  &amp;+ \rho\left(B(B&#39;\Omega^{k + 1}A&#39; - (Z^{k + 1})&#39; + (Z^{k + 1})&#39; - (Z^{k})&#39; - C&#39;)A \right)/2 \\
  &amp;= \partial f\left(\Omega^{k + 1} \right) + \left[ B\left((\Lambda^{k})&#39; + \rho(B&#39;\Omega^{k + 1}A&#39; - (Z^{k + 1})&#39; - C&#39;) \right)A \right]/2 \\
  &amp;+ \left[ A&#39;\left(\Lambda^{k} + \rho(A\Omega^{k + 1}B - Z^{k + 1} - c)B \right)B&#39; \right]/2 + \rho\left(B(Z^{k + 1} - Z^{k})&#39;A + A&#39;(Z^{k + 1} - Z^{k})B&#39; \right)/2 \\
  &amp;= \partial f\left(\Omega^{k + 1} \right) + \left(B(\Lambda^{k + 1})&#39;A + A&#39;\Lambda^{k + 1}B&#39; \right)/2 + \rho\left(B(Z^{k + 1} - Z^{k})&#39;A + A&#39;(Z^{k + 1} - Z^{k})B&#39; \right)/2 \\
  \Rightarrow 0 &amp;\in \rho\left( B(Z^{k + 1} - Z^{k})&#39;A + A&#39;(Z^{k + 1} - Z^{k})B&#39; \right)/2
\tag{A.22}\notag
\end{split}
\end{equation}\]</span></p>
</div>
<div id="proofpenregression" class="section level3">
<h3><span class="header-section-number">A.0.9</span> Proof of no closed-form solution</h3>
<p>Here we want to show that the following optimization problem cannot be solved in closed-form.</p>
<p><span class="math display" id="eq:penregression2">\[\begin{equation}
\hat{\Omega} = \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + \frac{\lambda}{2}\left\|\mathbb{X}\Omega\Sigma_{xy} - \mathbb{Y}\right\|_{F}^{2} \right\}
\tag{A.23}\notag
\end{equation}\]</span></p>
<p>First start by taking the gradient with respect to <span class="math inline">\(\Omega\)</span>:</p>
<p><span class="math display" id="eq:penregressionproof">\[\begin{equation}
\begin{split}
  \nabla_{\Omega}&amp;\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + \frac{\lambda}{2}\left\|\mathbb{X}\Omega\Sigma_{xy} - \mathbb{Y}\right\|_{F}^{2} \right\} \\
  &amp;= \nabla_{\Omega}\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + \frac{\lambda}{2}tr\left[\left(\mathbb{X}\Omega\Sigma_{xy} - \mathbb{Y}\right)&#39;\left(\mathbb{X}\Omega\Sigma_{xy} - \mathbb{Y}\right) \right] \right\} \\
  &amp;= \nabla_{\Omega}\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| + \frac{\lambda}{2}tr\left(\Omega\mathbb{X}&#39;\mathbb{X}\Omega\Sigma_{xy}\Sigma_{xy}&#39; - 2\Omega\Sigma_{xy}\mathbb{Y}&#39;\mathbb{X} \right) \right\} \\
  &amp;= 2S - S\circ I_{p} - 2\Omega^{-1} + \Omega^{-1}\circ I_{p} + \lambda\mathbb{X}&#39;\mathbb{X}\Omega\Sigma_{xy}\Sigma_{xy}&#39; + \lambda\Sigma_{xy}\Sigma_{xy}&#39;\Omega\mathbb{X}&#39;\mathbb{X} \\
  &amp;- \lambda\mathbb{X}&#39;\mathbb{X}\Omega\Sigma_{xy}\Sigma_{xy}&#39;\circ I_{p} - \Sigma_{xy}\mathbb{Y}&#39;\mathbb{X} - \mathbb{X}&#39;\mathbb{Y}\Sigma_{xy} + \Sigma_{xy}\mathbb{Y}&#39;\mathbb{X}\circ I_{P} \\
  \Rightarrow 0 &amp;= S - \hat{\Omega}^{-1} + \frac{\lambda}{2}\left(\mathbb{X}&#39;\mathbb{X}\hat{\Omega}\Sigma_{xy}\Sigma_{xy}&#39; + \Sigma_{xy}\Sigma_{xy}&#39;\hat{\Omega}\mathbb{X}&#39;\mathbb{X} \right) - \lambda\Sigma_{xy}\mathbb{Y}&#39;\mathbb{X}
\tag{A.24}\notag
\end{split}
\end{equation}\]</span></p>
<p>Note that we cannot isolate <span class="math inline">\(\hat{\Omega}\)</span>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-witten2009covariance">
<p>Witten, Daniela M, and Robert Tibshirani. 2009. “Covariance-Regularized Regression and Classification for High Dimensional Problems.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 71 (3). Wiley Online Library: 615–36.</p>
</div>
<div id="ref-price2015ridge">
<p>Price, Bradley S, Charles J Geyer, and Adam J Rothman. 2015. “Ridge Fusion in Statistical Learning.” <em>Journal of Computational and Graphical Statistics</em> 24 (2). Taylor &amp; Francis: 439–54.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scpme.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="admmsigma-r-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MGallow/oral_manuscript/edit/master/05-appendix.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Manuscript.pdf", "Manuscript.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
